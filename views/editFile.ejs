<!DOCTYPE html>
<html>
  <head>
    <title>Edit File</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 2em;
      }
      form {
        max-width: 400px;
      }
      label {
        display: block;
        margin-top: 1em;
      }
      input[type="text"],
      input[type="checkbox"] {
        margin-top: 0.5em;
      }
      .actions {
        margin-top: 2em;
      }
      .actions button,
      .actions a {
        margin-right: 1em;
      }
    </style>
  </head>
  <body>
    <h1>Edit File</h1>
    <form action="/files/edit/<%= file.id %>" method="POST">
      <label>
        File Name:
        <input type="text" name="name" value="<%= file.name %>" required />
      </label>
      <label>
        Sharable: <input type="checkbox" name="sharable" value="true" <%= file.sharable ? 'checked' : '' %>>
      </label>
        <label>
            Sharable Until:
            <%
            function toLocalDatetime(dt) {
            if (!dt) return '';
            const date = new Date(dt);
            const tzOffset = date.getTimezoneOffset() * 60000;
            const localISO = new Date(date - tzOffset).toISOString().slice(0,16);
            return localISO;
            }%>
            <input
            type="datetime-local"
            name="sharableUntil"
            value="<%= toLocalDatetime(file.sharableUntil) %>"
            />
        </label>
      <label>
      <div class="actions">
        <button type="submit">Save Changes</button>
        <a href="/files/<%= file.id %>">Return to File Info</a>
        <button
          type="submit"
          formaction="/files/delete/<%= file.id %>"
          formmethod="POST"
          onclick="return confirm('Are you sure you want to delete this file?');"
          style="color: red"
        >
          Delete File
        </button>
      </div>
    </form>
  </body>
</html>
